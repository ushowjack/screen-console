"use strict";function _interopRequireDefault(o){return o&&o.__esModule?o:{default:o}}function _classCallCheck(o,e){if(!(o instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_createClass=function(){function o(o,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(o,t.key,t)}}return function(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e}}(),_proxyPress2=require("./base/proxyPress"),_proxyPress3=_interopRequireDefault(_proxyPress2),ScreenConsole=function(){function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{logColor:"lightgreen",infoColor:"yellow",warnColor:"white",errorColor:"red",isShow:!1,isScrollToBack:!1};return _classCallCheck(this,o),"object"===_typeof(o.instance)?o.instance:(this.cacheInstance(),this.$body=document.querySelector("body"),this.$console=null,this.$consoleVirtualList="",this.$consoleList=[],this._console={},this._options=e,this)}return _createClass(o,[{key:"cacheInstance",value:function(){o.instance=this}},{key:"init",value:function(o){this.$console=this.createDOM({tag:"div",className:"console"}),this.saveConsoleFn(),this.$console.innerHTML=this.$consoleVirtualList,this._options.isShow&&this.consoleShow()}},{key:"saveConsoleFn",value:function(){var o=this.originalFnCallDecorator.bind(this);this._console.log=console.log,this._console.clear=console.clear,this._console.info=console.info,this._console.warn=console.warn,this._console.error=console.error,console.log=o(this.log,"log"),console.clear=o(this.clear,"clear"),console.info=o(this.info,"info"),console.warn=o(this.warn,"warn"),console.error=o(this.error,"error")}},{key:"originalFnCallDecorator",value:function(o,e){var n=this;return function(){o.apply(n,arguments),"function"==typeof n._console[e]&&n._console[e].apply(console,arguments)}}},{key:"extendsExports",value:function(o){if(o.toString().indexOf("console")>0)return!1;var e=this.genericLogger.bind(this);this.genericLogger=function(){o.call(this,arguments[1]),e.apply(this,arguments)}.bind(this)}},{key:"consoleShow",value:function(){if(!this.$console)return!1;if(this._options.isShow=!0,document.querySelector(".console")){this.$console.style.display="block";var o=this.createDOM({tag:"div",css:"width:500px;"});o.innerHTML=this.$consoleVirtualList,this.$consoleVirtualList="",this.appendDOM(o,this.$console)}else this.appendDOM(this.$console,this.$body),this.$console.innerHTML=this.$consoleVirtualList}},{key:"consoleHide",value:function(){return!!this._options.isShow&&(this._options.isShow=!1,this.$console.style.display="none",this.$consoleVirtualList="",!1)}},{key:"scrollToggle",value:function(){return this._options.isScrollToBack=!this._options.isScrollToBack,this._options.isScrollToBack}},{key:"destroy",value:function(){var o=this._console;this._options.isShow=!1,console.log=o.log,console.clear=o.clear,console.info=o.info,console.warn=o.warn,console.error=o.error,this.$body.removeChild(this.$console),this.clear(),this.$console=null}},{key:"createDOM",value:function(o){var e=o.tag,n=o.css,t=void 0===n?"width:500px;\n               position:fixed;\n               top:0;right:0;\n               max-height:500px;\n               min-height:200px;\n               overflow-y:auto;\n               background:rgba(0,0,0,0.7);":n,i=o.className,s=void 0===i?"":i,r=document.createElement(e);return r.style.cssText=t,r.className=s,r}},{key:"appendDOM",value:function(o,e){"object"===(void 0===o?"undefined":_typeof(o))?e.appendChild(o):e.innerHTML=o}},{key:"genericLogger",value:function(o,e){if(!this.$console)return!1;if(this._options.isShow){var n=document.createElement("pre");n.style.cssText="color:"+this._options[o+"Color"]+";\n                                    min-height:30px;\n                                    line-height:20px;\n                                    width:100%;\n                                    box-sizing:border-box;\n                                    word-wrap:break-word;\n                                    border-bottom: 1px solid white;\n                                    padding:5px;",n.textContent=e,this.appendDOM(n,this.$console),this._options.isScrollToBack&&(this.$console.scrollTop=this.$console.scrollHeight-this.$console.clientHeight)}else this.$consoleVirtualList+='<pre style="color:'+this._options[o+"Color"]+';\n                                                     min-height:30px;\n                                                     line-height:20px;\n                                                     width:100%;\n                                                     box-sizing:border-box;\n                                                     word-wrap:break-word;\n                                                     border-bottom: 1px solid white;\n                                                     padding:5px;">\n                                            '+e+"\n                                         </pre>"}},{key:"valtoString",value:function(o){for(var e="",n=0;n<arguments.length;n++)"object"==_typeof(arguments[n])?e+=JSON.stringify(arguments[n],null,2):e+=arguments[n];return e}},{key:"log",value:function(){var o=this.valtoString.apply(this,arguments);this.genericLogger("log",o)}},{key:"info",value:function(){var o=this.valtoString.apply(this,arguments);this.genericLogger("info",o)}},{key:"warn",value:function(){var o=this.valtoString.apply(this,arguments);this.genericLogger("warn",o)}},{key:"error",value:function(){var o=this.valtoString.apply(this,arguments);this.genericLogger("error",o)}},{key:"clear",value:function(){this.$consoleVirtualList="",this.$console.innerHTML=""}},{key:"proxyPress",value:function(o,e,n){return new _proxyPress3.default(o,e,n)}}]),o}();exports.default=ScreenConsole;